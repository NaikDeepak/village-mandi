---
phase: 07-ordering
plan: 03
type: execute
wave: 2
depends_on: ["07-01"]
files_modified: [web/src/stores/cart.ts, web/src/components/shop/CartDrawer.tsx, web/src/pages/buyer/CheckoutPage.tsx]
autonomous: false
---

<objective>
Implement Cart management and Checkout flow.

Purpose: Allow buyers to select items and place orders.
Output: Working Cart store, UI, and Checkout integration.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
@./.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-ordering/07-01-SUMMARY.md
</context>

<tasks>
<task type="auto">
  <name>Task 1: Cart Store</name>
  <files>web/src/stores/cart.ts</files>
  <action>
    Create Zustand store `useCartStore`.
    State: `items: { batchProductId, qty }[]`.
    Actions: `addItem`, `removeItem`, `updateQty`, `clearCart`.
    Computed: `totalAmount`, `totalItems`.
    Persist to localStorage using `persist` middleware.
  </action>
  <verify>N/A (Store logic)</verify>
  <done>Store implemented</done>
</task>

<task type="auto">
  <name>Task 2: Cart Drawer & Checkout</name>
  <files>web/src/components/shop/CartDrawer.tsx, web/src/pages/buyer/CheckoutPage.tsx</files>
  <action>
    CartDrawer: Slide-over showing current items, update +/- qty, remove.
    CheckoutPage:
    - Review items
    - Select Fulfillment (Pickup/Delivery)
    - Show breakdown: Subtotal, Facilitation Fee, Delivery Fee (mock 0 for now), Total.
    - "Place Order" button calls `ordersApi.create`.
    - Redirect to Success page on success.
  </action>
  <verify>npm run build</verify>
  <done>Checkout flow connected to API</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Full Ordering Flow</what-built>
  <how-to-verify>
    1. Log in as Admin -> Create Batch -> Open Batch.
    2. Log in as Buyer (or use separate browser).
    3. Visit Shop -> See products.
    4. Add to Cart -> Verify MinQty.
    5. Checkout -> Select Pickup.
    6. Place Order.
    7. Verify Order created in DB (Admin view or database).
  </how-to-verify>
  <resume-signal>Type "approved" if orders work end-to-end</resume-signal>
</task>
</tasks>

<verification>
- [ ] Cart persists on refresh
- [ ] Order placed successfully
- [ ] Totals match backend calculation
</verification>

<success_criteria>
- End-to-end ordering works
- Buyer experience is smooth
</success_criteria>

<output>
After completion, create `.planning/phases/07-ordering/07-03-SUMMARY.md`
</output>
